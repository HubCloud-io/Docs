
В листах данных в командной панели для настраиваемых кнопок существует возможность настроить команды, которые будут выполняться по нажатию на кнопку.

Фактически команда кнопки является процедурой на JavaScript, в которой доступны следующие переменные:

1. Context - модель страницы листа данных.
2. Workbook - Объект с набором листов данных (Sheet). В данный момент используется только один лист, доступный через свойство Workbook.FirstSheet.
3. Sheet - Активный лист (Sheet) объекта Workbook.
   
   Для вызова доступны следующие процедуры, вызываемые у объекта Context.
   
| Команда | Описание | Параметры |
|-------------------|-----|-------------|
| Context.Save(); | Сохраняет лист данных |  |
| Context.Close(); | Закрывает лист данных и возвращается в список |  |
| Context.GetValue( rowNumber, columnNumber); | Получает значение ячейки | rowNumber - номер строки, columnNumber - номер колонки |
| Context.SetValue(rowNumber, columnNumber, value); | Устанавливает значение ячейки | rowNumber - номер строки, columnNumber - номер колонки, value - новое значение |
| Context.OpenLink(link); | Открывает ссылку в новом окне | link - ссылка для открытия |



# Примеры

Получение и установка значения

```
// Получаем значения и выполняем вычисления.
var price = Context.GetValue(3,2) / Context.GetValue(4, 2);
// Устанавливаем новое значение по заданным координатам.
Context.SetValue(5, 2, price);
```

Открытие ссылки

```
// Собираем ссылку.
var link="/App/OperationV2/Edit/"+Context.GetValue(7, 2)+"/"+Context.GetValue(8, 2);

// Открываем полученную ссылку.
Context.OpenLink(link);
```

Использование условных операторов

```
// Получаем статус.
var status = Context.GetValue(10, 2);
if (status == 3 ){
  // Сохраняем лист данных.
  Context.Save();
}
else{
  // Статус неверный - выводим предупреждение в Sheet.
  Context.SetValue(11, 2, "Продолжаем работать!");
}

```

