
В листах данных в командной панели для настраиваемых кнопок существует возможность настроить команды, которые будут выполняться по нажатию на кнопку.

Фактически команда кнопки является процедурой на C#, в которой доступны функции:

   
| Функция | Описание | Параметры | Возвращаемое значение |
|-------------------|-----|-------------| --------------- |
| Save(); | Сохраняет лист данных |  | |
| Close(); | Закрывает лист данных и возвращается в список |  | |
| GetValue( rowNumber, columnNumber); | Получает значение ячейки | rowNumber - номер строки, columnNumber - номер колонки | |
| SetValue(rowNumber, columnNumber, value); | Устанавливает значение ячейки | rowNumber - номер строки, columnNumber - номер колонки, value - новое значение | |
| AwaitWorkflow(workflowName, resultStepName); | Вызывает процесс, дожидается его завершения и возвращает данные из шага, указанного во втором параметре | workflowName - имя процесса, resultStepName - имя результирующего шага| Объект - результат шага процесса |
| LogAdd(message); | Добавляет информационное сообщение в лог обработчиков | message - текст сообщения | |
| LogError(message); | Добавляет ошибку в лог обработчиков | message - текст ошибки | |





# Примеры

Получение и установка значения

```
// Получаем значения и выполняем вычисления.
var price = (decimal)GetValue(3,2) / (decimal)GetValue(4, 2);
// Устанавливаем новое значение по заданным координатам.
SetValue(5, 2, price);
```

Открытие ссылки

```
// Собираем ссылку.
var link="/App/OperationV2/Edit/"+GetValue(7, 2)+"/"+GetValue(8, 2);

// Открываем полученную ссылку.
OpenLink(link);
```

Использование условных операторов

```
// Получаем статус
var status = (int)GetValue(10, 2);
if (status == 3 ){
  // Статус верный - сохраняем лист данных.
  Save();
}
else{
 // Статус неверный - выводим предупреждение прямо на лист.
  SetValue(11, 2, "Продолжаем работать!");
}

```


Вызов процесса

```
// Выводим информационное сообщение в лог обработчиков.
LogAdd($"Start workflow: {DateTime.Now}");

// Запускаем процесс и ожидаем результат.
var result = (dynamic) AwaitWorkflow("data_sheet_call", "data_source");

// Выводим информационное сообщение в лог обработчиков.
LogAdd($"End workflow: {DateTime.Now}");

// Устанавливаем полученное значение в ячейку листа.
SetValue(12, 2, result.rate );


```